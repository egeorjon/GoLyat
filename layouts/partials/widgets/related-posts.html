{{/* Parameters */}}
{{/* .context   */}}
{{/* Params     */}}
{{/* .title     */}}
{{/* .type      */}}
{{/* .numposts  */}}
{{/* .columns   */}}
{{- $title         := .params.title | default "You may like the following posts also" -}}
{{- $numposts      := .params.numposts | default 3 -}}
{{- $widget_format := .params.type | default "image" -}}
{{- $related := site.RegularPages.Related .context | first $numposts -}}
{{- $class := partialCached "class-columns.html" (.params.columns | default (dict "def" 1 "sm" 1 "md" 3 "lg" 3 "xl" 3)) (printf "%s" .params.columns) -}}
{{- with $related.ByPublishDate.Reverse -}}
    <div class="col">
        {{- if eq $widget_format "image" -}}
            {{- with $title -}}
            <div class="row mb-2">
                <div class="col"><h3 class="card-title">{{- . | safeHTML -}}</h3></div>
            </div>
            {{- end -}}
            <div class="row {{ $class -}}">
                {{- range . -}}
                <div class="col">
                    <aside class="card h-100 widget widget-related widget-related-images">
                        {{- if isset .Params "images" -}}
                        <a href="{{- .RelPermalink -}}" title="{{- .Title | plainify | htmlUnescape -}}"></a>
                            {{- partial "partials/image.html" (dict "context" . "Destination" .Params.images "Title" .Title "Text" .Title "class" "card-img-top") -}}
                        </a>
                        {{- end -}}
                        <div class="card-body">
                            <p class="card-text">{{- .Lastmod | time.Format ($.Site.Params.FormatDate | default "2-Jan-2006") -}}</p>
                            <h4 class="card-title"><a href="{{- .RelPermalink -}}" title="{{- .Title | plainify | htmlUnescape -}}">{{- .Title -}}</a></h4>
                        </div>
                    </aside>
                </div><!-- col -->
                {{- end -}}
            </div><!-- row -->
        {{- else -}}
            <aside class="card h-100 widget widget-related widget-related-list">
                <div class="card-body">
                    {{- with $title -}}
                        <h3 class="card-title">{{- . | safeHTML -}}</h3>
                    {{- end -}}
                    <ul class="card-text">
                        {{- range . -}}
                        <li><a href="{{- .RelPermalink -}}" title="{{- .Title | plainify | htmlUnescape -}}">{{- .Title -}}</a></li>
                        {{- end -}}
                    </ul>
                </div><!-- card-body -->
            </aside>
        {{- end -}}
    </div><!-- col -->
{{- end -}}