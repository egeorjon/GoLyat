{{/* Parameters    */}}
{{/* .context      */}}
{{/* Params        */}}
{{/*    .title     */}}
{{/*    .type      */}}
{{/*    .columns   */}}
{{/*    .heading   */}}
{{- $context          := .context                                                                -}}
{{- $title            := .params.title | default (i18n "sections-list")                          -}}
{{- $widget_format    := .params.type | default "image-title"                                    -}}
{{- $heading_level    := int (.params.heading | default site.Data.default_params.widget_heading) -}}
{{- $heading_title    := printf "h%d" $heading_level                                             -}}
{{- $heading_subtitle := printf "h%d" (add $heading_level 1)                                     -}}
{{- $columns          := .params.columns | default site.Data.default_params.columns_4            -}}
{{- $class            := partialCached "partials/class-columns.html" $columns (delimit $columns "-") -}}
{{- with site.Params.mainSections -}}
    {{- if or (eq $widget_format "image-full") (eq $widget_format "image-title") -}}
        <div class="col widget widget-sections widget-sections-images">
            <div class="widget-inner">
                {{- with $title -}}
                    {{- (printf "<%s>%s</%s>" $heading_title . $heading_title) | safeHTML -}}
                {{- end -}}
                <div class="{{- $class -}}">
                    {{- range . -}}
                        {{- with site.GetPage . -}} 
                            <aside class="col">
                                {{- if isset .Params "images" -}}
                                    {{- partial "partials/image.html" (dict "context" . "Destination" .Params.images "Title" .Title "Text" .Title "Link" .RelPermalink) -}}
                                {{- end -}}
                                {{- (printf "<%s class=\"widget-title\"><a href=\"%s\" title=\"%s\">%s</a></%s>" $heading_subtitle .RelPermalink (.Title | plainify | htmlUnescape) .Title $heading_subtitle) | safeHTML -}}
                                {{- if eq $widget_format "image-full" -}}
                                    {{- with .Params.Description -}}
                                        <p class="widget-content">{{- . | plainify | htmlUnescape -}}</p>
                                    {{- end -}}
                                {{- end -}}
                            </aside>
                        {{- end -}}
                    {{- end -}}
                </div><!-- row -->
            </div><!-- widget-inner -->
        </div><!-- col -->
    {{- else -}}
        <aside class="col widget widget-sections widget-sections-list">
            <div class="widget-inner">
                {{- (printf "<%s class=\"widget-title\">%s</%s>" $heading_title . $heading_title) | safeHTML -}}
                <ul class="widget-content">
                    {{- range . -}}
                        <li><a href="{{- .RelPermalink -}}" title="{{- .Title | plainify | htmlUnescape -}}">{{- .Title -}}</a></li>
                    {{- end -}}
                </ul>
            </div>
        </aside>
    {{- end -}}
{{- end -}}