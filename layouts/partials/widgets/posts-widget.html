
{{/* Parameters   */}}
{{/* .context     */}}
{{/* .Param       */}}
{{/*   .title     */}}
{{/*   .type      */}}
{{/*   .numposts  */}}
{{/*   .columns   */}}
{{/* .posts       */}}
{{/* .title       */}}
{{- $title         := .title -}}
{{- $more          := .params.more | default false -}}
{{- $widget_format := .params.type | default "image" -}}
{{- $heading_level := int (.params.heading | default 3) -}}
{{- $heading_title := printf "h%d" $heading_level -}}
{{- $heading_subtitle := printf "h%d" (add $heading_level 1) -}}
{{- $columns       := .params.columns | default (dict "xs" 1 "sm" 1 "md" 2 "lg" 2 "xl" 2) -}}
{{- $class         := partialCached "partials/class-columns.html" $columns (delimit $columns "-") -}}
{{- with .posts -}}
    <div class="col">
        {{- if eq $widget_format "image" -}}
            {{- with $title -}}
            <div class="row">
                <div class="col">
                    {{- (printf "<%s>%s</%s>" $heading_title . $heading_title) | safeHTML -}}
                </div>
            </div>
            {{- end -}}
            <div class="{{ $class -}}">
                {{- range . -}}
                <div class="col mb-4">
                    <aside class="card h-100 widget widget-related widget-related-images">
                        {{- if isset .Params "images" -}}
                        <a href="{{- .RelPermalink -}}" title="{{- .Title | plainify | htmlUnescape -}}"></a>
                            {{- partial "partials/image.html" (dict "context" . "Destination" .Params.images "Title" .Title "Text" .Title "class" "card-img-top") -}}
                        </a>
                        {{- end -}}
                        <div class="card-body">
                            {{- (printf "<%s class=\"card-title\"><a href=\"%s\" title=\"%s\">%s</a></%s>" $heading_subtitle .RelPermalink (.Title | plainify | htmlUnescape) .Title $heading_subtitle) | safeHTML -}}
                            {{- with .Params.Description -}}<p class="card-text">{{- . | truncate 100 -}}</p>{{- end -}}
                            {{- partial "partials/meta.html" (dict "context" . "meta" (dict "1" "section" "2" "date")) -}}
                        </div>
                    </aside>
                </div><!-- col -->
                {{- end -}}
            </div><!-- row -->
            {{- with $more -}}
            <div class="row">
                <div class="col">
                    <p><a href="{{- . -}}">{{- i18n "see-more" -}}</a></p>
                </div>
            </div>
            {{- end -}}
        {{- else -}}
            <aside class="card h-100 widget widget-related widget-related-list">
                <div class="card-body">
                    {{- with $title -}}
                        <h3 class="card-title">{{- . | safeHTML -}}</h3>
                    {{- end -}}
                    <ul class="card-text">
                        {{- range . -}}
                        <li><a href="{{- .RelPermalink -}}" title="{{- .Title | plainify | htmlUnescape -}}">{{- .Title -}}</a></li>
                        {{- end -}}
                    </ul>
                </div><!-- card-body -->
            </aside>
        {{- end -}}
    </div><!-- col -->
{{- end -}}