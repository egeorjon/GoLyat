{{- define "main" -}}
    {{- $current_page := . -}}
    {{- partial "partials/headline.html" . -}}
    <section id="page-content">
        <div class="container limit-width">
            <div class="row">
                <div class="col post-summary mb-4">
                    {{- .Summary -}}
                </div><!-- col -->
            </div><!-- row -->
        </div><!-- container -->
    {{- $display_image  := and (isset .Params "images") (.Site.Params.Single.displayimage | default false) -}}
    {{- if $display_image -}}
        <div class="container">
            <div class="row">
                <div class="col mb-5 text-center">
                    {{- partial "partials/image.html" (dict "context" . "Destination" .Params.images "Title" .Title "Text" .Title) -}}
                </div><!-- col -->
            </div><!-- row -->
        </div><!-- container -->
    {{- end -}}
        <div class="container limit-width">
            <div class="row row-cols-1">
                <div class="col">
                {{- with .Site.Params.Single.metatop -}}
                    {{- partial "partials/meta.html" (dict "context" $current_page "kindctx" "page" "meta" . "class" "meta-top") -}}
                {{- end -}}
                </div>
                <div class="page-content post-content col mb-6">
                    {{- .Content -}}
                    {{/*- replace .Content .Summary "" | safeHTML -*/}}
                </div><!-- col -->
            </div><!-- row -->
        </div><!-- container -->
    </section>
    {{- partial "partials/pagination-single.html" . -}}
    {{/*- $defaultBottomline := slice 
        (dict "name" "authors" "columns" (dict "sm" 1 "md" 1 "lg" 1 "xl" 1) "limitedWidth" true "Widgets" (slice 
                (dict "wtype" "authors" "weight" 1 "cache" false "params" (dict  ))
            )
        )
        (dict "name" "tags-share" "columns" (dict "sm" 1 "md" 2 "lg" 2 "xl" 2) "limitedWidth" true "Widgets" (slice 
                (dict "wtype" "post-tags" "weight" 1 "cache" false "params" (dict  ))
                (dict "wtype" "share-links" "weight" 2 "cache" false "params" (dict  ))
            )
        )
        (dict "name" "related" "columns" (dict "sm" 1 "md" 1 "lg" 1 "xl" 1) "limitedWidth" false "Widgets" (slice 
                (dict "wtype" "related-posts" "weight" 1 "cache" false "params" (dict "numposts" 4 "columns" (dict "sm" 1 "md" 2 "lg" 2 "xl" 2) ))
            )
        )
        (dict "name" "popular" "columns" (dict "sm" 1 "md" 1 "lg" 1 "xl" 1) "limitedWidth" false "Widgets" (slice 
                (dict "wtype" "most-popular" "weight" 1 "cache" false "params" (dict "columns" (dict "sm" 1 "md" 2 "lg" 2 "xl" 2) ))
            )
        )
     -*/}}
    
    {{- range .Site.Params.Single.Rows | default .Site.Data.single_bottomline.rows -}}{{/* $defaultBottomline */}}
        <section class="page-bottomline page-bottomline-{{- .name}} mb-5">
            {{- $limit := cond (.limitedWidth | default true) "limit-width" "" -}}
            <div class="container {{ $limit -}}">
                {{- $class := partialCached "class-columns.html" (.columns | default (dict "sm" 1 "md" 1 "lg" 1 "xl" 1)) (printf "%s" .columns) -}}
                <div class="row {{ $class -}}">
                    {{- range .Widgets -}}
                        {{- $partialPath := printf "partials/widgets/%s.html" .wtype -}}
                        {{- if templates.Exists $partialPath -}}
                            {{- if .cache | default false -}}
                                {{- partialCached $partialPath (dict "context" $current_page "params" .params) (printf "%s-%s" .wtype .params) -}}
                            {{- else -}}
                                {{- partial $partialPath (dict "context" $current_page "params" .params) -}}
                            {{- end -}}
                        {{- else -}}
                            {{- partial "partials/widgets/default.html" (dict "context" $current_page "params" .wtype) -}}
                        {{- end -}}
                    {{- end -}}
                </div><!-- row -->
            </div><!-- container -->
        </section>
    {{- end -}}
{{- end -}}