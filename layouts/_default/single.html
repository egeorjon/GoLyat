{{- define "main" -}}
    {{- $current_page := . -}}
    <div class="container limit-width">
        <div class="row">
            <div class="col post-summary mb-4">
                {{- .Summary -}}
            </div><!-- col -->
        </div><!-- row -->
    </div><!-- container -->
{{- $display_image  := and (isset .Params "images") (site.Params.Single.displayimage | default false) -}}
{{- if $display_image -}}
    <div class="container">
        <div class="row">
            <div class="col mb-5 text-center">
                {{- partial "partials/image.html" (dict "context" . "Destination" .Params.images "Title" .Title "Text" .Title) -}}
            </div><!-- col -->
        </div><!-- row -->
    </div><!-- container -->
{{- end -}}
    <div class="container limit-width">
        <div class="row row-cols-1">
            <div class="col">
            {{- with site.Params.Single.metatop -}}
                {{- partial "partials/meta.html" (dict "context" $current_page "kindctx" "page" "meta" . "class" "meta-top") -}}
            {{- end -}}
            </div>
            <div class="page-content post-content col mb-5">
                {{/*- if or (.Params.Toc | default false) (site.Params.Single.TableOfContents | default false ) -*/}}
                {{- if .Params.Toc | default site.Params.Single.TableOfContents | default false -}}
                <aside class="card toc mb-3 d-none d-md-block">
                    <div class="card-header">
                        {{- i18n "toc" -}}
                    </div>
                    <div class="card-body">
                        {{- .TableOfContents -}}
                    </div>
                </aside>
                {{- end -}}
                {{/*- .Content -*/}}
                {{- replace .Content .Summary "" | safeHTML -}}
            </div><!-- col -->
        </div><!-- row -->
    </div><!-- container -->
{{- end -}}
{{- define "bottomline" -}}
    {{- $current_page := . -}}
    {{- partial "partials/pagination-single.html" . -}}

    {{- range site.Params.Single.Rows | default site.Data.single_bottomline.Rows -}}{{/* $defaultBottomline */}}
        <section class="page-bottomline page-bottomline-{{- .name}} mb-5">
            {{- $limit := cond (.limitedWidth | default true) "limit-width" "" -}}
            <div class="container {{ $limit -}}">
                {{- $columns := .columns | default (dict "xs" 1 "sm" 1 "md" 1 "lg" 1 "xl" 1) -}}
                {{- $class := partialCached "partials/class-columns.html" $columns (delimit $columns "-") -}}
                <div class="{{- $class -}}">
                    {{- $num_groups := len .Groups -}}
                    {{ range .Groups }}
                        {{- $num_widgets := len .Widgets -}}
                        {{- $columns := .columns | default (dict "xs" 1 "sm" 1 "md" 1 "lg" 1 "xl" 1) -}}
                        {{- $class := partialCached "partials/class-columns.html" $columns (delimit $columns "-") -}}
                        {{- if and (gt $num_groups 1) (gt $num_widgets 1) -}}
                        <div class="col">
                            <div class="{{- $class -}}">
                        {{- end -}}
                            {{- range .Widgets -}}
                                {{- $partialPath := printf "partials/widgets/%s.html" .widget -}}
                                {{- if templates.Exists $partialPath -}}
                                    {{- if .cache | default false -}}
                                        {{- partialCached $partialPath (dict "context" $current_page "params" .params) (printf "%s-%s" .widget .params) -}}
                                    {{- else -}}
                                        {{- partial $partialPath (dict "context" $current_page "params" .params) -}}
                                    {{- end -}}
                                {{- else -}}
                                    {{- partial "partials/widgets/default.html" (dict "context" $current_page "params" (dict "widget" .widget)) -}}
                                {{- end -}}
                            {{- end -}}
                        {{- if and (gt $num_groups 1) (gt $num_widgets 1) -}}
                            </div><!-- row -->                            
                        </div><!-- col -->
                        {{- end -}}
                    {{- end -}}
                </div><!-- row -->
            </div><!-- end of container -->
        </section>
    {{- end -}}
{{- end -}}